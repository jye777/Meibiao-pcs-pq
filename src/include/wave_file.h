/**
 * @file			wave_file.h
 * @brief			
 * @author		wangyongjian
 * @date			2016/5/6
 * @version			Initial Draft
 * @par				Copyright (C),  2013-2023, SCNEE
 * @par History:
 * 1.Date: 			2017/3/27
 *   Author: 			wangyongjian
 *   Modification: 		Created file
 * 测试程序
*/

#ifndef WAVE_FILE_H
#define WAVE_FILE_H

#include <stdint.h>
#include "record_wave.h"

/*******宏定义*****************************************************************************/
#define WAVE_FILE_MAXSIZE   		524288000            			//500M 500 * 1024 * 1024 文件长度
#define FAULT_LENGTH 						sizeof(_fault_save_data)	//一条故障长度
#define FAULT_BRIEF							sizeof(_fault_save_brief)	//故障状态信息数据长度
#define FAULT_PARA							sizeof(_fault_save_para)	//故障参数数据长度
#define FAULT_WAVE							sizeof(_fault_save_wave)	//故障波形数据长度
#define	ADDR_OFFSET_BRIEF				0													//故障状态信息偏移地址
#define	ADDR_OFFSET_PARA				FAULT_BRIEF								//故障参数偏移地址
#define ADDR_OFFSET_WAVE				(FAULT_BRIEF+FAULT_PARA)	//故障波形偏移地址
#define ADDR_OFFSET_FAULTSTAT		2													//第一条故障偏移地址
#define FAULT_MAX    						5													//记录最大故障数



//typedef struct 
//{
//		uint32_t curnum;
//		uint32_t addr[FAULT_MAX];
//		_fault_save_data  fault;
//}WAVEFILE;

/*******函数声明***************************************************************************/
//------------------------------------------------------------------------------------------
//已存储故障数读取**************************************************************************
//------------------------------------------------------------------------------------------
uint8_t faultnum_read(void);
//------------------------------------------------------------------------------------------
//读取第rd_num条故障的数据******************************************************************
//------------------------------------------------------------------------------------------
uint8_t fault_read(uint16_t rd_num);
//------------------------------------------------------------------------------------------
//读取第rd_num条故障状态信息****************************************************************
//------------------------------------------------------------------------------------------
uint8_t fault_read_brief(uint16_t rd_num);
//------------------------------------------------------------------------------------------
//读取第rd_num条故障参数数据****************************************************************
//------------------------------------------------------------------------------------------
uint8_t fault_read_para(_fault_save_para* fualt_para,uint16_t rd_num);
//------------------------------------------------------------------------------------------
//读取第rd_num条故障波形数据****************************************************************
//------------------------------------------------------------------------------------------
uint8_t fault_read_wave(_fault_save_wave* fualt_wave,uint16_t rd_num);
//------------------------------------------------------------------------------------------
//获取已存储故障数，其他文件调用************************************************************
//------------------------------------------------------------------------------------------
uint16_t getfaultnum(void);
//------------------------------------------------------------------------------------------
//故障文件初始化****************************************************************************
//------------------------------------------------------------------------------------------
uint8_t wave_file_int(void);
//------------------------------------------------------------------------------------------
//存储一条新故障****************************************************************************
//------------------------------------------------------------------------------------------
void fault_write(void);
//------------------------------------------------------------------------------------------
//文件管理系统及NANDFLASH测试***************************************************************
//------------------------------------------------------------------------------------------
int wavere_test_init(void);

#endif 
